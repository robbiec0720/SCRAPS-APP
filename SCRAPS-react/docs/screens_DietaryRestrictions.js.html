<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: screens/DietaryRestrictions.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: screens/DietaryRestrictions.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { View, Text, ScrollView } from 'react-native';
import React, { useContext, useState } from 'react';
import SubmitButton from '../component/SubmitButton';
import { AuthContext } from '../context/authContext';
import { styles } from '../styles/styles'
import { loginStyles } from '../styles/loginStyles';
import axios from 'axios';
import { EXPO_NODE_URL } from "@env";

/**
 * Component for managing user dietary restrictions.
 * 
 * This component displays buttons for various dietary restrictions,
 * allowing the user to toggle them on and off.
 * It also includes a save button to update the user's dietary restrictions.
 * 
 * @param {object} navigation - The navigation object provided by React Navigation.
 * @returns {JSX.Element} - Returns the JSX element for the dietary restrictions screen.
 */

export default function DietaryRestrictions({navigation}){
    // State variables for managing user login and clicked buttons
    const [login, setLogin] = useContext(AuthContext);
    const [clickedButtons, setClickedButtons] = useState({
        Shellfish: false,
        Lactose: false,
        Gluten: false,
        Nut: false,
        Vegetarian: false,
        Pescatarian: false,
        Vegan: false,
        Kosher: false,
        Halal: false,
    });

    /**
     * Handles the click event for a button.
     * 
     * This function toggles the state of a button when clicked.
     * It updates the state of `clickedButtons` to reflect the clicked status of the button.
     * It also updates the user context stored in `login.user` to reflect the clicked status of the button.
     * 
     * @param {string} buttonName The name of the button that was clicked.
     * @returns {void}
     */

    const handleClick = (buttonName) => {
        setClickedButtons({ ...clickedButtons, [buttonName]: !clickedButtons[buttonName] });

        // Update login.user context here
        setLogin(prevLogin => ({
            ...prevLogin,
            user: {
                ...prevLogin.user,
                [buttonName.toLowerCase()]: !prevLogin.user[buttonName.toLowerCase()]
            }
        }));
    };

    /**
     * Handles the save operation for updating dietary restrictions.
     * 
     * This function sends a POST request to the server to update the user's dietary restrictions.
     * It includes the user's dietary restrictions as parameters in the request payload.
     * After the request is sent, it displays an alert with the response message, if available.
     * Finally, it navigates to the user profile screen.
     * 
     * @returns {void}
     */

    const handleSave = async () => {
        try {
            const { data } = await axios.post(
                `${EXPO_NODE_URL}`+':8080/api/v1/user/updateDietaryRestrictions', 
                {
                    vegetarian: login.user.vegetarian,
                    vegan: login.user.vegan,
                    halal: login.user.halal,
                    kosher: login.user.kosher,
                    lactose: login.user.lactose,
                    gluten: login.user.gluten,
                    nut: login.user.nut,
                    shellfish: login.user.shellfish,
                    pescatarian: login.user.pescatarian,
                    id: login.user.id
                }
                );
            alert(data &amp;&amp; data.message);
            navigation.navigate('UserProfile');
        } catch (err) {
            console.log(err);
        }
    }
    
    return (
        &lt;View style={styles.homeContainer}>
            &lt;ScrollView style = {loginStyles.scrollView}>
                &lt;View style = {loginStyles.header}>
                    &lt;Text style = {styles.boldtext}>DIETARY RESTRICTIONS&lt;/Text>
                &lt;/View>
                &lt;View>
                    &lt;View style={loginStyles.card}>
                        &lt;Text style={loginStyles.cardheader}>ALLERGIES&lt;/Text>
                        &lt;View style={loginStyles.buttonContainer}>
                        &lt;SubmitButton
                                buttonName={'Shellfish'}
                                handleSubmit={() => handleClick('Shellfish')}
                                loading={false}
                                clicked={clickedButtons['Shellfish']}
                                userHasRestriction={login.user.shellfish} 
                            />
                            &lt;SubmitButton
                                buttonName={'Lactose'}
                                handleSubmit={() => handleClick('Lactose')}
                                loading={false}
                                clicked={clickedButtons['Lactose']}
                                userHasRestriction={login.user.lactose} 
                            />
                            &lt;SubmitButton
                                buttonName={'Gluten'}
                                handleSubmit={() => handleClick('Gluten')}
                                loading={false}
                                clicked={clickedButtons['Gluten']}
                                userHasRestriction={login.user.gluten} 
                            />
                            &lt;SubmitButton
                                buttonName={'Nut'}
                                handleSubmit={() => handleClick('Nut')}
                                loading={false}
                                clicked={clickedButtons['Nut']}
                                userHasRestriction={login.user.nut} 
                            />
                        &lt;/View>
                    &lt;/View>
                    &lt;View style={loginStyles.card}>
                        &lt;Text style={loginStyles.cardheader}>RELATIONSHIP WITH MEAT&lt;/Text>
                        &lt;View style={loginStyles.buttonContainer}>
                            &lt;SubmitButton
                                buttonName={'Pescatarian'}
                                handleSubmit={() => handleClick('Pescatarian')}
                                loading={false}
                                clicked={clickedButtons['Pescatarian']}
                                userHasRestriction={login.user.pescatarian} 
                                />
                            &lt;SubmitButton 
                                buttonName={'Vegetarian'}
                                handleSubmit={() => handleClick('Vegetarian')}
                                loading={false}
                                clicked={clickedButtons['Vegetarian']}
                                userHasRestriction={login.user.vegetarian} 
                            />
                            &lt;SubmitButton 
                                buttonName={'Vegan'}
                                handleSubmit={() => handleClick('Vegan')}
                                loading={false}
                                clicked={clickedButtons['Vegan']}
                                userHasRestriction={login.user.vegan} 
                            />
                        &lt;/View>
                    &lt;/View>
                    &lt;View style={loginStyles.card}>
                        &lt;Text style={loginStyles.cardheader}>RELIGION&lt;/Text>
                        &lt;View style={loginStyles.buttonContainer}>
                            &lt;SubmitButton 
                                buttonName={'Kosher'}
                                handleSubmit={() => handleClick('Kosher')}
                                loading={false}
                                clicked={clickedButtons['Kosher']}
                                userHasRestriction={login.user.kosher} 
                            />
                            &lt;SubmitButton 
                                buttonName={'Halal'}
                                handleSubmit={() => handleClick('Halal')}
                                loading={false}
                                clicked={clickedButtons['Halal']}
                                userHasRestriction={login.user.halal} 
                            />
                        &lt;/View>
                    &lt;/View>
                    &lt;View style={loginStyles.submit}>
                            &lt;SubmitButton 
                                buttonName={'Save Preferences'} 
                                handleSubmit={handleSave}
                            />
                    &lt;/View>
                &lt;/View>
            &lt;/ScrollView>
        &lt;/View>
    )
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Button-component.html">Button-component</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AuthProvider">AuthProvider</a></li><li><a href="global.html#CallRecipes">CallRecipes</a></li><li><a href="global.html#CustomTabbutton">CustomTabbutton</a></li><li><a href="global.html#ImageProvider">ImageProvider</a></li><li><a href="global.html#InfoProvider">InfoProvider</a></li><li><a href="global.html#IngredientProvider">IngredientProvider</a></li><li><a href="global.html#RecipeCard">RecipeCard</a></li><li><a href="global.html#handleLinkPress">handleLinkPress</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Apr 30 2024 19:53:40 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
